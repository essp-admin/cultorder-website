<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cult Order</title>
    
    <meta property="og:title" content="Cult Order">
    <meta property="og:description" content="Search, choose, and receive.">
    <meta property="og:image" content="https://tuweb.com/og-image-co.png">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://tuweb.com/og-image-co.png">

    <link rel="stylesheet" href="style.css">
    <style>
        body {
            background-color: #000;
            margin: 0;
            display: flex;
            flex-direction: column; 
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'OCRAStd', monospace;
            color: #da0008; 
            text-align: center;
            font-size: 0.9rem;
            user-select: none;
            overflow: hidden;
        }

        #status-message {
            letter-spacing: 3px;
            font-size: 0.75rem;
            margin-bottom: 20px;
            height: 1.2rem;
        }

        .game-buttons {
            display: flex;
            gap: 15px; 
        }

        .sacred-button {
            width: 45px; height: 45px;
            line-height: 45px;
            border: 1px solid #da0008;
            background: transparent;
            color: #da0008;
            cursor: pointer;
            transition: none;
        }

        .sacred-button.active {
            background-color: #da0008;
            color: #000;
        }

        /* Reward Screen */
        #reward-screen {
            display: none;
            flex-direction: column;
            width: 85%;
            max-width: 600px;
            align-items: center;
            cursor: pointer; /* Indica que se puede pulsar para volver */
        }

        #reward-text {
            line-height: 1.6;
            margin-bottom: 40px;
            min-height: 5rem;
        }

        .cursor {
            animation: blink 0.8s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        .options-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            opacity: 0;
            transition: opacity 0.8s ease;
        }

        .option-btn {
            background: none;
            border: none;
            color: #da0008;
            font-family: 'OCRAStd', monospace;
            cursor: pointer;
            font-size: 0.8rem;
            letter-spacing: 2px;
            padding: 10px;
        }

        .option-btn:hover {
            text-decoration: underline;
        }

        .glitch-text { color: #555 !important; }
    </style>
</head>
<body>
    
    <div id="game-state">
        <div id="status-message"></div>
        <div class="game-buttons">
            <div class="sacred-button" id="btn-1">1</div>
            <div class="sacred-button" id="btn-3">3</div>
            <div class="sacred-button" id="btn-5">5</div>
            <div class="sacred-button" id="btn-7">7</div>
        </div>
    </div>

    <div id="reward-screen">
        <div id="reward-text"></div>
        <div class="options-container" id="options"></div>
    </div>

    <script>
        const sequence = [7, 1, 5, 3];
        let playerSequence = [];
        let isDisplaying = false;
        let isFinalPhase = false; // Control para la redirección final

        const msg = document.getElementById('status-message');
        const rewardScreen = document.getElementById('reward-screen');
        const rewardText = document.getElementById('reward-text');
        const optionsContainer = document.getElementById('options');
        const chars = "$%&/!#?@<>[]{}*=+";

        function typeEffect(text, target) {
            return new Promise(resolve => {
                target.innerHTML = "";
                let i = 0;
                function type() {
                    if (i < text.length) {
                        target.innerHTML = text.substring(0, i + 1) + '<span class="cursor">_</span>';
                        i++;
                        setTimeout(type, 40);
                    } else {
                        resolve();
                    }
                }
                type();
            });
        }

        function glitchEffect(target, finalMsg) {
            let iterations = 0;
            const interval = setInterval(() => {
                target.innerHTML = finalMsg.split("").map(() => chars[Math.floor(Math.random() * chars.length)]).join("") + '<span class="cursor">_</span>';
                if (++iterations > 15) {
                    clearInterval(interval);
                    target.innerHTML = finalMsg + '<span class="cursor">_</span>';
                    target.classList.add('glitch-text');
                    setTimeout(() => location.reload(), 3000);
                }
            }, 80);
        }

        async function showPhase(type) {
            optionsContainer.style.opacity = "0";
            optionsContainer.innerHTML = "";

            if (type === 'start') {
                document.getElementById('game-state').style.display = 'none';
                rewardScreen.style.display = 'flex';
                await typeEffect("Do you prefer to know the whole, painful truth, or just the part that allows for a peaceful life?", rewardText);
                optionsContainer.innerHTML = `
                    <button class="option-btn" onclick="event.stopPropagation(); showPhase('truth')">[ THE TRUTH ]</button>
                    <button class="option-btn" onclick="event.stopPropagation(); showPhase('paradox')">[ PEACEFUL LIFE ]</button>
                `;
            } 
            else if (type === 'paradox') {
                await typeEffect("PEACE REQUIRES IGNORANCE. ARE YOU SURE?", rewardText);
                optionsContainer.innerHTML = `
                    <button class="option-btn" onclick="event.stopPropagation(); showPhase('glitch')">[ YES ]</button>
                    <button class="option-btn" onclick="event.stopPropagation(); showPhase('truth')">[ NO, I WANT THE TRUTH ]</button>
                `;
            }
            else if (type === 'glitch') {
                glitchEffect(rewardText, "// ERROR: NO MESSAGE FOUND.");
                return;
            }
            else if (type === 'truth') {
                await typeEffect("Search, choose, and receive. The revelation will awaken inside you.", rewardText);
                isFinalPhase = true; // Habilitamos la vuelta a casa al pulsar
            }
            optionsContainer.style.opacity = "1";
        }

        // Redirección al pulsar la pantalla final
        rewardScreen.addEventListener('click', () => {
            if (isFinalPhase) {
                location.reload(); // Vuelve al inicio del index.html
            }
        });

        async function runSequence() {
            isDisplaying = true;
            msg.textContent = "//OBSERVE THE NUMBERS";
            await new Promise(r => setTimeout(r, 1200));
            msg.textContent = "//INTERNALIZE THEM";
            await new Promise(r => setTimeout(r, 800));
            for (let s of sequence) {
                const btn = document.getElementById(`btn-${s}`);
                btn.classList.add('active');
                await new Promise(r => setTimeout(r, 500));
                btn.classList.remove('active');
                await new Promise(r => setTimeout(r, 200));
            }
            isDisplaying = false;
            msg.textContent = "//REPEAT THE PATTERN";
        }

        document.querySelectorAll('.sacred-button').forEach(btn => {
            btn.onclick = () => {
                if (isDisplaying) return;
                const val = parseInt(btn.textContent);
                btn.classList.add('active');
                setTimeout(() => btn.classList.remove('active'), 150);
                playerSequence.push(val);
                if (val !== sequence[playerSequence.length - 1]) {
                    msg.textContent = "//ACCESS DENIED. FAILURE.";
                    playerSequence = [];
                    setTimeout(runSequence, 1500);
                    return;
                }
                if (playerSequence.length === sequence.length) {
                    msg.textContent = "//SEQUENCE ASCENDED.";
                    setTimeout(() => showPhase('start'), 1000);
                }
            };
        });

        setTimeout(runSequence, 2000);
    </script>
</body>
</html>

